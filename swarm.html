<html>
<head> <title>smart-swarm</title> <style> body { margin: 0; } canvas { width: 100%; height: 100% } </style> </head>
<body> <script src="http://threejs.org/build/three.min.js"></script>
<script>
                        var numBoids = prompt("Enter the number of agents (around 100).");
                        var gravityStrength = prompt("Enter the strength of gravity (around 1 to 9).") * 0.0005;
                        var dim = 100;
                        function Boid () {
                            this.pos = new THREE.Vector3( (Math.random()*dim)-(dim/2), (Math.random()*dim)-(dim/2), (Math.random()*dim)-(dim/2));
                            this.vel = new THREE.Vector3( Math.random(), Math.random(), Math.random() );
                            this.mat = new THREE.PointCloudMaterial( { color: new THREE.Color( Math.random(), Math.random(), Math.random() ) } );
                            this.updatePos = function(centerOfGravity) {
                                this.vel = (this.vel.multiplyScalar(1-gravityStrength)).add(((centerOfGravity.multiplyScalar(1/numBoids)).sub(this.pos)).multiplyScalar(gravityStrength));
                                this.pos = this.pos.add(this.vel);
                                if (this.pos.x > dim/2) this.pos.x = this.pos.x - dim; if (this.pos.x < (0-dim/2)) this.pos.x = this.pos.x + dim;
                                if (this.pos.y > dim/2) this.pos.y = this.pos.y - dim; if (this.pos.y < (0-dim/2)) this.pos.y = this.pos.y + dim;
                                if (this.pos.z > dim/2) this.pos.z = this.pos.z - dim; if (this.pos.z < (0-dim/2)) this.pos.z = this.pos.z + dim;
                            };
                        }
                        var camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 1000 );
                        var renderer = new THREE.WebGLRenderer();
                        renderer.setSize( window.innerWidth, window.innerHeight );
                        document.body.appendChild( renderer.domElement );
                        camera.position.z = dim/2;
                        var boids = [];
                        for (var i=0; i<numBoids; i++) boids[i] = new Boid();

                        var render = function () {
                                var scene = new THREE.Scene();
                                var centerOfGravity = new THREE.Vector3(0, 0, 0);
                        for (var i=0; i<numBoids; i++) centerOfGravity = centerOfGravity.add(boids[i].pos);
                                for (var i=0; i<numBoids; i++) {
                                        boids[i].updatePos(centerOfGravity);
                                        var geometry = new THREE.Geometry();
                                        geometry.vertices.push( boids[i].pos);
                                        scene.add( new THREE.PointCloud(geometry, boids[i].mat) );
                                }
                                requestAnimationFrame( render );
                                renderer.render( scene, camera );
                        };

                        render();
</script>
</body>
</html>
